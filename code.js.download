/*! Copyright (C) 2013 Doulos, All Rights Reserved. */
;var VHDL="VHDL",SPECMAN_AND_VERILOG="Specman e + SV/Verilog",PYTHON_AND_VERILOG="Python 2.7 + Verilog/SV",PYTHON_ONLY="Python 2.7 only",CPP_ONLY="C++ only",PERL="Perl",CSH="Csh";function Code(a,d,c,b){this.TEXT_MAX_SIZE=0;this.TOTAL_TEXT_MAX_SIZE=0;this.MAX_RESULT_LINES=0;this.RUN_POLL_INTERVAL=500;this.SIMULATORS_REQUIRING_VALIDATED=[];this.DISABLE_TOGETHERJS_MIRRORING=false;this.designTabs=a;this.testbenchTabs=d;this.contextPath=c;this.descriptionMarkdown=b;this.pollRunResultsTimeout=null;this.resultIndex=0;this.stopRequested=false;this.pollRunResults=function(){var e=$.ajax({type:"POST",url:this.contextPath+"/getResults",data:{id:$("#runId").val(),startIndex:this.resultIndex,cachebuster:Math.random(),_csrf:$("#_csrfToken").val()},context:this});e.done(function(i){var g="";if(i.stackTrace){g+='<span class="ERROR">'+htmlEncode(i.message)+"</span><br/>";clearRunButtons()}else{if(i==="notFound"){if(!this.stopRequested){g+='<span class="ERROR">This process not found on server.</span><br/>'}clearRunButtons()}else{var f=$.parseJSON(i);this.resultIndex+=f.length;var h=function(j,l){var k=l.data;switch(l.itemType){case"COMMAND":if(k==="Waiting for download..."){this.getFile()}else{if(k==="Opening circuit diagram..."){this.getFile("svg")}else{if(k==="Opening netlist file..."){this.getFile("html")}else{if(k==="Opening HTML file..."){this.getFile("html")}else{if(k==="Opening EPWave..."){this.launchEpwave()}}}}}k="["+l.date+"] "+k;break;case"EXIT":clearRunButtons();break;default:}g+='<span class="'+l.itemType+'">'+k+"</span><br/>"};$.each(f,_.bind(h,this))}}if(g){$("#results").append(g);this.scrollToBottomOfResults();if(!DISABLE_TOGETHERJS_MIRRORING){fireTogetherJSResults()}}});e.always(function(){clearTimeout(this.pollRunResultsTimeout);if($("#codeRunning").val()==="1"){this.pollRunResultsTimeout=setTimeout(_.bind(this.pollRunResults,this),this.RUN_POLL_INTERVAL)}})};this.getFile=function(f){var e=window.open(this.contextPath+"/getFile?id="+$("#runId").val()+"&type="+f);if(e===null||typeof(e)==="undefined"){$("#alertModalText").text('Could not download file. Please disable your pop-up blocker and click "Run" again.');$("#alertModal").modal();this.stopRun()}};this.launchEpwave=function(){if(POP_UP_EPWAVE){var f=window.open("","LaunchEPWave");if(f===null||typeof(f)==="undefined"){$("#alertModalText").text('Could not open EPWave. Please disable your pop-up blocker and click "Run" again.');$("#alertModal").modal();this.stopRun()}else{$("#launchEpwaveId").val($("#runId").val());$("#launchEpwaveLink").val(document.location);$("#launchEpwaveForm").submit()}}else{var j="/embed/launchEpwave?id="+$("#runId").val()+"&link="+encodeURIComponent(document.location)+"&from="+encodeURIComponent(location.protocol+"//"+location.host);var h=$("#epwaveModal"),g='<iframe id="epwaveFrame" width="100%" height="100%"" frameborder="0" src="'+j+'"/>';var e=function(){$("#epwaveFrame").css("visibility","hidden")},i=function(){setTimeout(function(){$("#epwaveFrame").css("visibility","visible");$("#epwaveFrame").width("99%");$("#epwaveFrame").width("100%")},200)};if($(".epwaveModal").length){$("#epwaveFrame").replaceWith(g);e();h.dockmodal("popout")}else{h.dockmodal({initialState:"modal",title:"EPWave",poppedOutDistance:"1%",animationSpeed:300,showPopout:false,dialogClass:"epwaveModal",open:function(){$(g).appendTo(h.parent())},beforeMinimize:e,beforeClose:function(){$("#epwaveFrame").remove()},popout:i})}}};this.initialize=function(){this.scrollToBottomOfResults()};this.sendCodeView=function(){var h=codeId.value;if(h>0&&!isUserOwnsCode()){var e=sessionStorage.getItem(h);if(!e){$.get("/codeView",{codeId:h});sessionStorage.setItem(h,true);var g=$("#numberViews");var f=parseInt(g.html())+1;g.html(f);$("#numberOfViews").val(f)}}};this.toggleLike=function(){var e=$("#numberLikes");var h=$("#likeButton");var g=codeId.value;if(g>0&&isLoggedIn()){var f;if(h.hasClass("fa-thumbs-o-up")){var f=parseInt(e.html())+1;h.removeClass("fa-thumbs-o-up");h.addClass("fa-thumbs-up");$.get("/codeLike",{codeId:g,userId:getLoggedInUserId()})}else{f=parseInt(e.html())-1;h.removeClass("fa-thumbs-up");h.addClass("fa-thumbs-o-up");$.get("/codeUnlike",{codeId:g,userId:getLoggedInUserId()})}e.html(f);$("#numberOfLikes").val(f)}};this.scrollToBottomOfResults=function(){var e=$("#bottomTabsPanels");e.scrollTop(e.prop("scrollHeight"))};this.showLogInModal=function(){$("#logInModalText").text("You must log in before running or saving the playground code.");$("#logInModal").modal()};this.setCodeForm=function(j,i){$(".has-error").removeClass("has-error");if(!i&&!isLoggedIn()){this.showLogInModal();return false}var f=$.trim($("#module").val());var e=$("#testbenchLanguage").val();var g=getSelectedSimulator();if(j==="run"&&!this.validateCodeForRun(e,g,f)){return false}var h=$("#codeForm");$('input[name^="libraries"]',h).remove();$('input[name^="properties"]',h).remove();$('input[name^="files"]',h).remove();this.saveActiveTabIndex(j,h);if(!this.validateFiles(h)){return false}h.attr("action",j);$("#codeName").val($.trim($("#name").val()));if($.trim(b.value()).length>8192){alert("Description must be less than 8192 characters, including formatting tags");return false}$("#codeDescription").val($.trim(b.value()));this.setSimulatorOptions(h,e,g,f);this.setDownloadOption(h);$("#codeResult").val(this.trimResult(j));$("#codePermissionLevelId").val($("#permissionLevelId").val());this.setLanguageAndLibraries(h,e);return true};this.validateCodeForRun=function(g,h,f){if(!USER_CAN_USE_VALIDATED_SIMULATORS&&this.SIMULATORS_REQUIRING_VALIDATED.indexOf(parseInt(h))>-1){return this.validatedAccessRequired("#simulatorGroup")}if(h===$("#codeSimulatorNotAvailable").val()){return this.flagValidationError("Simulator "+$("#codeSimulatorText").val()+" is not available.","#simulatorGroup")}var e={status:true};switch(g){case VHDL:this.validateVhdl(h,e);this.validateVunit(h,e);this.validateUseRunDo(h,e);this.validateUseRunBash(h,e);this.validateUseRunDoPrecision(h,e);this.validateUseRunDoHesSyntheser(h,e);break;case PYTHON_AND_VERILOG:this.validatePythonVerilog(h,e);break;case SPECMAN_AND_VERILOG:this.validateSpecmanVerilog(h,e);break;case PYTHON_ONLY:this.validatePythonOnly(h,e);break;case CPP_ONLY:this.validateCppOnly(h,e);break;case PERL:this.validatePerl(h,e);break;case CSH:this.validateCsh(h,e);break;default:var i=getSelectedSimulatorType(h);this.validateVerilogSimulator(h,e);this.validateVerilogMethodology(h,e);this.validateVerilogLibrary(i,e);this.validateUseRunDo(h,e);this.validateUseRunBash(h,e);this.validateUseRunDoPrecision(h,e);this.validateUseRunDoHesSyntheser(h,e);this.validateUseRunYs(h,e);this.validateSVX(h,e);this.validateEasierUVM(h,e);this.validateVunit(h,e);break}this.validateModule(h,f,e);return e.status};this.validateVhdl=function(h,e){if(!$("#topEntity").val().trim()&&!($("#vunit").is(":checked")||$("#vunitvhdl").is(":checked")||isPrecisionSelected(h)||isHesSyntheserSelected(h))){e.status=this.flagValidationError("Top entity must be specified for VHDL.","#topEntityGroup");return}if(!isIncisiveSelected(h)&&!isModelsimSelected(h)&&!isRivieraSelected(h)&&!isQuestaSelected(h)&&!isVcsSelected(h)&&!isGHDLselected(h)&&!isPrecisionSelected(h)&&!isHesSyntheserSelected(h)){e.status=this.flagValidationError($("#simulator option:selected").text()+" does not support VHDL.","#simulatorGroup");return}var j=$("#vhdlLibrary :selected");for(var f=0;f<j.length&&e.status;f++){var g=j.get(f).value;switch(g){case"401":break;case"1201":if(!isRivieraSelected(h)&&!isQuestaSelected(h)&&!isGHDLselected(h)){e.status=this.flagValidationError($("#simulator option:selected").text()+" currently does not support OSVVM.","#simulatorGroup");return}break;case"1202":if(!isUVVMcompatibleRivieraSelected(h)&&!isUVVMcompatibleQuestaSelected(h)&&!isGHDLselected(h)){e.status=this.flagValidationError($("#simulator option:selected").text()+" currently does not support UVVM.","#simulatorGroup");return}break;default:}}};this.validateSpecmanVerilog=function(f,e){if(!isIncisiveSelected(f)){e.status=this.flagValidationError("Please select Cadence Xcelium with "+$("#specmanVersion option:selected").text()+".","#simulatorGroup")}};this.validatePythonVerilog=function(f,e){if(!isIcarusVerilogSelected(f)&&!isSynthesisSelected(f)){e.status=this.flagValidationError($("#simulator option:selected").text()+" does not support "+$("#pythonMethodology option:selected").text()+". Currently only Icarus Verilog 0.9.x supports cocotb.","#simulatorGroup")}};this.validateCppOnly=function(f,e){if(!isCppSelected(f)){e.status=this.flagValidationError("C++/SystemC co-simulation is currently not supported. Please select the C++ compiler.","#simulatorGroup")}};this.validatePerl=function(f,e){if(!isPerlSelected(f)){e.status=this.flagValidationError("Perl co-simulation is currently not supported. Please select the Perl compiler.","#simulatorGroup")}};this.validateCsh=function(f,e){if(!isCshSelected(f)){e.status=this.flagValidationError("Running Csh with other tools is currently not supported. Please select Csh in Tools & Simulators.","#simulatorGroup")}};this.validatePythonOnly=function(g,f){var e=$("#pythonOnlyMethodology").val();if(isSynthesisSelected(g)){if(isVtrSelected(g)){f.status=this.flagValidationError("MyHDL/Migen synthesis with VTR flow currently not supported. Try Yosys.","#simulatorGroup")}else{if(isMigenSelected(e)&&!$("#topClass").val().trim()){f.status=this.flagValidationError("Top class must be specified, like 'MyModule()'","#migenOptionsGroup")}}}else{if(isMigenSelected(e)){if(!isIcarusVerilogSelected(g)){f.status=this.flagValidationError("To sim Migen, Icarus Verilog simulator must be selected in 'Tools & Simulators' dropdown.","#simulatorGroup")}}else{if(!isPythonSelected(g)){f.status=this.flagValidationError("Python compiler must be selected in 'Tools & Simulators' dropdown.Co-simulation is currently not available for MyHDL.","#simulatorGroup")}}}};this.validateVerilogSimulator=function(f,e){if(e.status&&(isPythonSelected(f)||isCppSelected(f)||isPerlSelected(f)||isCshSelected(f))){e.status=this.flagValidationError("C++/Perl/Python/Csh compilers do not support Verilog. Please select a Simulator.","#simulatorGroup")}if(e.status&&(isGHDLselected(f))){e.status=this.flagValidationError("GHDL does not support Verilog. Please select a different simulator.","#simulatorGroup")}};this.validateVerilogMethodology=function(g,e){var f=$("#methodologyLibrary option:selected").val();if(e.status&&f){if(f===$("#libraryNotAvailableId").val()){e.status=this.flagValidationError("Library "+$("#libraryNotAvailable").val()+" is not available.");return}if(!isSimulatorSupportLibraries()){e.status=this.flagValidationError($("#simulator option:selected").text()+" does not support libraries. Try another simulator.","#simulatorGroup");return}if(isIcarusVerilogSelected(g)||isPandaSelected(g)){e.status=this.flagValidationError($("#simulator option:selected").text()+" does not support UVM/OVM.","#simulatorGroup");return}}};this.validateSVX=function(f,e){var g=$("#svx").is(":checked");if(g&&!isIncisiveSelected(f)&&!isRivieraSelected(f)){e.status=this.flagValidationError("TLV support for "+$("#simulator option:selected").text()+" is not available.","#simulatorGroup")}};this.validateEasierUVM=function(f,e){var g=$("#easier_uvm").is(":checked");if(g&&!isRivieraSelected(f)&&!isQuestaSelected(f)&&!isVcsSelected(f)&&!isIncisiveSelected(f)){e.status=this.flagValidationError("Easier UVM support for "+$("#simulator option:selected").text()+" is not available.","#simulatorGroup")}};this.validateVunit=function(g,e){var f=$("#vunit").is(":checked")||$("#vunitvhdl").is(":checked");if(f&&!isRivieraSelected(g)){e.status=this.flagValidationError("Vunit support for "+$("#simulator option:selected").text()+" is not yet available.","#simulatorGroup")}};this.validateVerilogLibrary=function(j,e){var g=$("#otherLibrary :selected");for(var f=0;f<g.length&&e.status;f++){var h=g.get(f).value;switch(h){case"201":e.status=this.validateTBS(j);break;case"301":e.status=this.validateSVUnit(j);break;case"401":e.status=this.validateOVL(j);break;case"901":e.status=this.validateSvlib(j);break;case"1101":e.status=this.validateClueLib(j);break;case"1601":e.status=this.validateSVAUnit(j);break;default:}}};this.validateUseRunDo=function(f,e){if(e.status&&(((isModelsimSelected(f)&&$("#modelsimUseRunDo").is(":checked"))||(isRivieraSelected(f)&&($("#rivieraUseRunDo").is(":checked")||$("#rivieraVhdlUseRunDo").is(":checked")))||(isIncisiveSelected(f)&&($("#incisivUseRunDo").is(":checked")||$("#incisivVhdlUseRunDo").is(":checked")))||(isVcsSelected(f)&&($("#vcsUseRunDo").is(":checked")||$("#vcsVhdlUseRunDo").is(":checked")))||(isQuestaSelected(f)&&($("#questaUseRunDo").is(":checked")||$("#questaVhdlUseRunDo").is(":checked"))))&&!(this.fileExistsInTabs(a,"run.do")||this.fileExistsInTabs(d,"run.do")))){var g=isIncisiveSelected(f)?"#incisivUseRunDoDiv":(isIncisiveSelected(f)?"#incisivVhdlUseRunDoDiv":(isVcsSelected(f)?"#vcsUseRunDoDiv":(isVcsSelected(f)?"#vcsVhdlUseRunDoDiv":(isRivieraSelected(f)?"#rivieraUseRunDoDiv":(isRivieraSelected(f)?"#rivieraVhdlUseRunDoDiv":(isQuestaSelected(f)?"#questaUseRunDoDiv":(isQuestaSelected(f)?"#questaVhdlUseRunDoDiv":(isModelsimSelected(f)?"#modelsimUseRunDoDiv":"#questaUseRunDoDiv"))))))));e.status=this.flagValidationError("Please create a 'run.do' file with simulation commands.",g);return}};this.validateUseRunBash=function(f,e){if(e.status&&(((isModelsimSelected(f)&&$("#modelsimUseRunBash").is(":checked"))||(isRivieraSelected(f)&&($("#rivieraUseRunBash").is(":checked")||$("#rivieraVhdlUseRunBash").is(":checked")))||(isIncisiveSelected(f)&&($("#incisivUseRunBash").is(":checked")||$("#incisivVhdlUseRunBash").is(":checked")))||(isVcsSelected(f)&&($("#vcsUseRunBash").is(":checked")||$("#vcsVhdlUseRunBash").is(":checked")))||(isQuestaSelected(f)&&($("#questaUseRunBash").is(":checked")||$("#questaVhdlUseRunBash").is(":checked"))))&&!(this.fileExistsInTabs(a,"run.bash")||this.fileExistsInTabs(d,"run.bash")))){var g=isIncisiveSelected(f)?"#incisivUseRunBashDiv":(isIncisiveSelected(f)?"#incisivVhdlUseRunBashDiv":(isVcsSelected(f)?"#vcsUseRunBashDiv":(isVcsSelected(f)?"#vcsVhdlUseRunBashDiv":(isRivieraSelected(f)?"#rivieraUseRunBashDiv":(isRivieraSelected(f)?"#rivieraVhdlUseRunBashDiv":(isQuestaSelected(f)?"#questaUseRunBashDiv":(isQuestaSelected(f)?"#questaVhdlUseRunBashDiv":(isModelsimSelected(f)?"#modelsimUseRunBashDiv":"#questaUseRunBashDiv"))))))));e.status=this.flagValidationError("Please create a 'run.bash' file with simulation commands.",g);return}};this.validateUseRunYs=function(f,e){if(e.status&&((isYosysSelected(f)&&$("#yosysUseRunDo").is(":checked"))&&!(this.fileExistsInTabs(a,"run.ys")||this.fileExistsInTabs(d,"run.ys")))){var g="#yosysUseRunDoDiv";e.status=this.flagValidationError("Please create a 'run.ys' file containing synthesis commands.",g);return}};this.validateUseRunDoPrecision=function(f,e){if(e.status&&isPrecisionSelected(f)&&!(this.fileExistsInTabs(a,"run.do")||this.fileExistsInTabs(d,"run.do"))){var g="#precisionUseRunDoDiv";e.status=this.flagValidationError("Please create a 'run.do' file containing synthesis commands.",g);return}};this.validateUseRunDoHesSyntheser=function(f,e){if(e.status&&isHesSyntheserSelected(f)&&!(this.fileExistsInTabs(a,"run.do")||this.fileExistsInTabs(d,"run.do"))){var g="#hesSyntheserUseRunDoDiv";e.status=this.flagValidationError("Please create a 'run.do' file containing synthesis commands.",g);return}};this.validateTBS=function(e){switch(e){case"Icarus":case"Panda":case"Questa":case"VTR":case"Yosys":return true;default:return this.flagValidationError("Currently, only Icarus Verilog supports TBS library.","#simulatorGroup")}};this.validateSVUnit=function(e){switch(e){case"Riviera":case"ModelSim":case"Questa":case"VCS":case"INCISIV":case"VTR":case"Yosys":return true;default:return this.flagValidationError($("#simulator option:selected").text()+" currently does not support SVUnit. Support coming soon.","#simulatorGroup")}};this.validateSVAUnit=function(e){switch(e){case"VCS":return true;default:return this.flagValidationError($("#simulator option:selected").text()+" currently does not support SVAUnit. Support coming soon.","#simulatorGroup")}};this.validateSvlib=function(e){switch(e){case"VTR":case"Yosys":return true;default:return this.flagValidationError($("#simulator option:selected").text()+" currently does not support svlib.","#simulatorGroup")}};this.validateClueLib=function(e){switch(e){case"ModelSim":case"VTR":case"Yosys":return true;default:return this.flagValidationError($("#simulator option:selected").text()+" currently does not support ClueLib.","#simulatorGroup")}};this.validateOVL=function(e){switch(e){case"Riviera":case"Icarus":case"ModelSim":case"Questa":case"VCS":case"INCISIV":case"VTR":case"Yosys":case"Panda":return true;default:return this.flagValidationError($("#simulator option:selected").text()+" currently does not support OVL.","#simulatorGroup")}};this.validateModule=function(g,f,e){if(e.status&&isPandaSelected(g)){var h=/^[a-zA-Z0-9._%+-]+$/;if(!f.match(h)){e.status=this.flagValidationError("Top Module must match regular expression: "+h,"#moduleDiv")}}};this.trimResult=function(f){var e="";if(f!=="run"){var g=$("#results > span, #results > br");if(g.length>2*this.MAX_RESULT_LINES){g=g.slice(-(2*this.MAX_RESULT_LINES));e+='<span class="COMMAND"">Last '+this.MAX_RESULT_LINES+" lines of result:</span><br/>"}g.each(function(h,i){e+=i.outerHTML});if(e.length>this.TEXT_MAX_SIZE){e="<span>Not saved due to large size.</span>"}}return e};this.saveActiveTabIndex=function(h,g){if(h!=="run"){var f=a.getActiveIndex();if(f){this.appendPropertyToForm(g,"designTabsActiveIndex",f)}var e=d.getActiveIndex();if(e){this.appendPropertyToForm(g,"testbenchTabsActiveIndex",e)}}};this.validateFiles=function(f){a.editors.design0.name=$("#designTabsButtons a:first").text();d.editors.testbench0.name=$("#testbenchTabsButtons a:first").text();var e={count:0};if(!this.validateFilesInTabs(f,a,"design",e)||!this.validateFilesInTabs(f,d,"testbench",e)){return false}return true};this.validateFilesInTabs=function(k,h,i,g){var e=0;for(var f in h.editors){if(h.editors.hasOwnProperty(f)){var j=h.editors[f].editor.getDoc().getValue();if(j.length>this.TEXT_MAX_SIZE){return this.flagValidationError(h.editors[f].name+" code must be less than "+this.TEXT_MAX_SIZE+" characters.")}e+=j.length;if(f===i+"0"){$("#code"+capitalizeFirstLetter(i)).val(j)}else{k.append('<input name="files['+g.count+'].count" type="hidden" value="'+g.count+'"/>');k.append('<input name="files['+g.count+'].type" type="hidden" value="'+i.toUpperCase()+'"/>');k.append('<input name="files['+g.count+'].name" type="hidden" value="'+h.editors[f].name+'"/>');k.append('<input name="files['+g.count+'].contents" type="hidden"/>');$('input[name="files['+g.count+'].contents"]',k).val(j);g.count++}}}if(e>this.TOTAL_TEXT_MAX_SIZE){return this.flagValidationError("Code across all files must be less than "+this.TOTAL_TEXT_MAX_SIZE+" characters.")}return true};this.fileExistsInTabs=function(f,g){for(var e in f.editors){if(f.editors[e].name===g){return true}}return false};this.setSimulatorOptions=function(i,f,h,e){var g=getSelectedSimulatorType(h);switch(g){case"GHDL":case"Icarus":case"Riviera":case"Questa":case"VCS":case"INCISIV":this.setGHDLoptions(f);this.setRivieraOptions(f);this.setIcarusOptions(h);this.setQuestaOptions(f);this.setVcsOptions(f);this.setIncisivOptions(f);break;case"ModelSim":this.setModelsimOptions(f);break;case"Yosys":this.setYosysOptions(i);break;case"Precision":this.setPrecisionOptions(i);break;case"HES-SyntHESer":this.setHesSyntheserOptions(i);break;case"CPP":this.setCppOptions(i);break;case"Perl":this.setCompileRunOptions("perlArgs");break;case"Csh":this.setCompileRunOptions("cshArgs");break;case"Panda":this.setPandaOptions(e);break;default:break}if($("#openEpwaveAfterRun").is(":checked")&&$("#openEpwave").is(":visible")){this.appendPropertyToForm(i,"epwave",true)}if($("#tlvShow").is(":checked")){this.appendPropertyToForm(i,"tlvShow",true)}$("#codeSimulatorId").val($("#simulator option:selected").val())};this.setIcarusOptions=function(f){var e=isIcarusVerilog09Selected(f)?"icarusVerilog09CompileOptions":"icarusVerilogCompileOptions";var g=isIcarusVerilog09Selected(f)?"icarusVerilog09RunOptions":"icarusVerilogRunOptions";this.setCompileRunOptions(e,g)};this.setModelsimOptions=function(e){if(e===VHDL){this.setCompileRunOptions("modelsimVhdlCompileOptions","modelsimVhdlRunOptions","modelsimVhdlRunTime")}else{this.setCompileRunOptions("modelsimCompileOptions","modelsimRunOptions","modelsimRunTime");if($("#modelsimUseRunDo").is(":checked")){this.setOption("modelsimUseRunDo",true)}}};this.setGHDLoptions=function(e){this.setCompileRunOptions("GHDLimportOptions","GHDLmakeOptions","GHDLrunOptions","GHDLsimulatorOptions")};this.setRivieraOptions=function(e){if(e===VHDL){this.setCompileRunOptions("rivieraVhdlCompileOptions","rivieraVhdlRunOptions","rivieraVhdlRunTime");if($("#rivieraVhdlUseRunDo").is(":checked")){this.setOption("rivieraVhdlUseRunDo",true)}if($("#rivieraVhdlUseRunBash").is(":checked")){this.setOption("rivieraVhdlUseRunBash",true)}}else{this.setCompileRunOptions("rivieraCompileOptions","rivieraRunOptions","rivieraRunTime");if($("#rivieraUseRunDo").is(":checked")){this.setOption("rivieraUseRunDo",true)}if($("#rivieraUseRunBash").is(":checked")){this.setOption("rivieraUseRunBash",true)}}};this.setQuestaOptions=function(e){if(e===VHDL){this.setCompileRunOptions("questaVhdlCompileOptions","questaVhdlRunOptions","questaVhdlRunTime");if($("#questaVhdlUseRunDo").is(":checked")){this.setOption("questaVhdlUseRunDo",true)}if($("#questaVhdlUseRunBash").is(":checked")){this.setOption("questaVhdlUseRunBash",true)}}else{this.setCompileRunOptions("questaCompileOptions","questaRunOptions","questaRunTime");if($("#questaUseRunDo").is(":checked")){this.setOption("questaUseRunDo",true)}if($("#questaUseRunBash").is(":checked")){this.setOption("questaUseRunBash",true)}}};this.setVcsOptions=function(e){if(e===VHDL){this.setCompileRunOptions("vcsVhdlCompileOptions","vcsVhdlRunOptions","vcsVhdlRunTime");if($("#vcsVhdlUseRunDo").is(":checked")){this.setOption("vcsVhdlUseRunDo",true)}if($("#vcsVhdlUseRunBash").is(":checked")){this.setOption("vcsVhdlUseRunBash",true)}}else{this.setCompileRunOptions("vcsCompileOptions","vcsRunOptions","vcsRunTime");if($("#vcsUseRunDo").is(":checked")){this.setOption("vcsUseRunDo",true)}if($("#vcsUseRunBash").is(":checked")){this.setOption("vcsUseRunBash",true)}}};this.setIncisivOptions=function(e){if(e===VHDL){this.setCompileRunOptions("incisivVhdlCompileOptions","incisivVhdlRunOptions");if($("#incisivVhdlUseRunDo").is(":checked")){this.setOption("incisivVhdlUseRunDo",true)}if($("#incisivVhdlUseRunBash").is(":checked")){this.setOption("incisivVhdlUseRunBash",true)}}else{this.setCompileRunOptions("incisivCompileOptions","incisivRunOptions");if($("#incisivUseRunDo").is(":checked")){this.setOption("incisivUseRunDo",true)}if($("#incisivUseRunBash").is(":checked")){this.setOption("incisivUseRunBash",true)}}};this.setYosysOptions=function(g){if($("#yosysShow").is(":checked")){this.appendPropertyToForm(g,"yosysShow",true)}if($("#yosysUseRunDo").is(":checked")){this.appendPropertyToForm(g,"yosysUseRunDo",true)}var e=$("#yosysSynthesisOptions option:selected");if(e.length){for(var f=0;f<e.length;f++){var h=e.get(f).value;if(h){this.appendPropertyToForm(g,h,true)}}}};this.setPrecisionOptions=function(g){var e=$("#precisionSynthesisOptions option:selected");if($("#precisionShow").is(":checked")){this.appendPropertyToForm(g,"precisionShow",true)}if($("#precisionUseRunDo").is(":checked")){this.setOption("precisionUseRunDo",true)}if(e.length){for(var f=0;f<e.length;f++){var h=e.get(f).value;if(h){this.appendPropertyToForm(g,h,true)}}}};this.setHesSyntheserOptions=function(g){var e=$("#hesSyntheserSynthesisOptions option:selected");if($("#hesSyntheserShow").is(":checked")){this.appendPropertyToForm(g,"hesSyntheserShow",true)}if($("#hesSyntheserUseRunDo").is(":checked")){this.setOption("hesSyntheserUseRunDo",true)}if(e.length){for(var f=0;f<e.length;f++){var h=e.get(f).value;if(h){this.appendPropertyToForm(g,h,true)}}}};this.setCppOptions=function(f){this.setCompileRunOptions("cppCompileOptions","cppRunOptions");if($("#cppPedanticWall").is(":checked")){this.appendPropertyToForm(f,"cppPedanticWall",true)}var h=$("#cppStandard option:selected");if(h.length){for(var e=0;e<h.length;e++){var g=h.get(e).value;if(g){this.appendPropertyToForm(f,g,true)}}}};this.setPandaOptions=function(e){$("#codeModule").val(e)};this.setDownloadOption=function(e){if($("#resultZip").is(":checked")){this.appendPropertyToForm(e,"result.zip",true)}};this.setLanguageAndLibraries=function(j,h){var e={methodologyLibrary:null,otherLibrary:null};if(h&&h!="SystemVerilog/Verilog"){this.getNonVerilogLibraries(j,h,e);if($("#vunitvhdl").is(":checked")){this.setOption("vunitvhdl","true");this.setOption("vunitVhdlRunOptions",$("#vunitVhdlRunOptions").val())}}else{e.methodologyLibrary=$("#methodologyLibrary").val();e.otherLibrary=$("#otherLibrary option:selected");if($("#svx").is(":checked")){this.setOption("svx","true")}if($("#easier_uvm").is(":checked")){this.setOption("easier_uvm","true")}if($("#vunit").is(":checked")){this.setOption("vunit","true");this.setOption("vunitRunOptions",$("#vunitRunOptions").val())}}var f=0;if(e.methodologyLibrary){$("#codeForm").append('<input name="libraries['+f+++'].id.lookupId" type="hidden" value="'+e.methodologyLibrary+'"/>')}if(e.otherLibrary&&e.otherLibrary.length){for(var g=0;g<e.otherLibrary.length;g++){if(e.otherLibrary.get(g).value){$("#codeForm").append('<input name="libraries['+f+++'].id.lookupId" type="hidden" value="'+e.otherLibrary.get(g).value+'"/>')}}}};this.getNonVerilogLibraries=function(g,f,e){$("#codeForm").append('<input name="properties[\'testbenchLanguage\'].property" type="hidden" value="'+f+'"/>');$("#codeForm").append('<input name="properties[\'testbenchLanguage\'].name" type="hidden" value="testbenchLanguage"/>');switch(f){case VHDL:var i=$("#topEntity").val();if(i){this.appendPropertyToForm(g,"topEntity",i)}e.otherLibrary=$("#vhdlLibrary option:selected");break;case SPECMAN_AND_VERILOG:e.methodologyLibrary=$("#specmanVersion").val();break;case PYTHON_AND_VERILOG:e.methodologyLibrary=$("#pythonMethodology").val();break;case CPP_ONLY:e.otherLibrary=$("#cppLibrary option:selected");break;case PYTHON_ONLY:e.methodologyLibrary=$("#pythonOnlyMethodology").val();if(isMigenSelected(e.methodologyLibrary)){var h=$("#topClass").val();if(h){this.appendPropertyToForm(g,"topClass",h)}}break;default:}};this.appendPropertyToForm=function(f,e,g){f.append('<input name="properties['+e+'].name" type="hidden" value="'+e+'"/>');f.append('<input name="properties['+e+'].property" type="hidden"/>');$('input[name="properties['+e+'].property"]',f).val(g)};this.setCompileRunOptions=function(g,e,k,f){this.setOption(g,$("#"+g).val());var j=$("#"+e);if(j.length){this.setOption(e,j.val())}var i=$("#"+k);if(i.length){this.setOption(k,i.val())}var h=$("#"+f);if(h.length){this.setOption(f,h.val())}};this.setOption=function(f,e){$("#codeForm").append("<input name=\"properties['"+f+'\'].property" type="hidden" />');$("#codeForm input[name='properties\\[\\'"+f+"\\'\\].property']").val(e);$("#codeForm").append("<input name=\"properties['"+f+'\'].name" type="hidden" value="'+f+'"/>')};this.flagValidationError=function(e,f){$("#validationModalText").text(e);$("#validationModal").modal();if(f){$(f).addClass("has-error")}return false};this.validatedAccessRequired=function(e){$("#validatedAccessRequiredModal").modal();if(e){$(e).addClass("has-error")}return false};this.startRun=function(){if($("#simulator").val()===null){alert("Please select a valid tool or simulator using the Tools & Simulators menu on the left.");return false}if(!this.setCodeForm("run")){return false}$(".bottom-tabs").tabs("option","active",0);this.stopRequested=false;$("#results").empty();var e=$("#codeForm");checkToken(_.bind(function(){var f=$.ajax({type:"POST",url:this.contextPath+"/run?cachebuster="+Math.random(),data:e.serializeArray(),context:this});f.done(function(g){if(typeof g==="string"&&g.match("^validationError.*")){alert("Validation error. This is likely due to a bug in this application.");sendGA("home","home_error",g)}else{if(g.stackTrace){alert("Error: "+g.message);sendGA("home","home_error",g.message)}else{if(g.uuid){$("#runId").val(g.uuid);setRunButtons();this.resultIndex=0;this.pollRunResults()}else{window.location.href=this.contextPath+"/redirect"}}}var h=$("#simulator option:selected").html()+"-"+$("#testbenchLanguage option:selected").html();h=h.replace(/Verilog/g,"Vg").replace("Riviera-PRO EDU","Riv").replace(/\+/g,"").replace(/\//g,"").replace(/ /g,"");sendGA("home","home_run",h)});f.fail(function(g,h){alert("Error connecting to server. Run request failed: "+h)})},this))};this.stopRun=function(){this.stopRequested=true;clearTimeout(this.pollRunResultsTimeout);var e=$.ajax({type:"POST",url:this.contextPath+"/kill",data:{id:$("#runId").val(),cachebuster:Math.random(),_csrf:$("#_csrfToken").val()},context:this});e.done(function(f){if(f.stackTrace){alert("Server error: "+f.message)}else{clearRunButtons()}});e.fail(function(f,g){alert("Error connecting to server. Kill request failed: "+g)})};this.save=function(f){if($("#simulator").val()===null){alert("Please select a valid tool or simulator using the Tools & Simulators menu on the left.");sendGA("home","home_save","select_valid_tool");return false}if(!this.setCodeForm(f.data.action)){sendGA("home","home_save","code_error");return false}if($(f.target).hasClass("saving")){return false}var g=f.data.action===(c+"/save");var e=g&&$("#codeId").val()!=="0";checkToken(function(){if(e){$(f.target).addClass("saving");$(f.target).addClass("disabled");$.ajax({type:"POST",url:"/ajaxSave",timeout:20000,data:$("#codeForm").serialize(),success:function(h){$(f.target).removeClass("saving");$(f.target).removeClass("disabled");if(h==="success"){clearChangeIndicator()}else{if(!!!hideErrors){alert("Could not save your code, please check your internet connection. If this persists you may wish to save your code locally and logout then login.\n"+h)}}},error:function(h){$(f.target).removeClass("saving");$(f.target).removeClass("disabled");if(!!!hideErrors){alert("Could not save your code, please check your internet connection. If this persists you may wish to save your code locally and logout then login.")}}})}else{if(g){clearChangeIndicator()}$(window).unbind("beforeunload");$("#codeForm").submit()}});if(f.target.getAttribute("id")==="copyButton"){sendGA("home","home_copy")}if(f.target.id==="saveButton"){sendGA("home","home_save","success")}if(f.target.id==="saveBottomButton"){sendGA("home","home_save_tab","success")}};this.forceSave=function(){if(!this.setCodeForm(c+"/copy",1)){$("#logInModal").modal("hide");return false}checkToken(function(){$(window).unbind("beforeunload");trackEvent("home","home_run_loginSaveEdits");var e=$("#codeForm");e.attr("action",c+"/copyOnce");e.attr("method","get");e.submit()})}};